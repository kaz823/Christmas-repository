<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>── Merry Christmas ──</title>
<style>
  body {
    background: #000;
    margin: 0;
    overflow: hidden;
    text-align: center;
    color: #fff;
    font-family: "Yu Mincho", serif;
  }
  h1 {
    position: relative;
    z-index: 1000;
    margin-top: 50px;
    font-weight: normal;
    letter-spacing: 0.1em;
  }
  p {
    position: relative;
    z-index: 1000;
    margin-top: 20px;
  }
  button {
    position: relative;
    z-index: 1000;
    margin-top: 40px;
    padding: 12px 28px;
    font-size: 18px;
    font-family: "Yu Mincho", serif;
    cursor: pointer;
  }
  canvas { 
    position: fixed; 
    top:0; left:0; 
    width:100%; height:100%; 
    pointer-events:none; 
    z-index:999; 
  }
</style>
</head>
<body>

<h1>── Merry Christmas ──</h1>
<p>素敵なクリスマスが訪れますように。</p>

<button onclick="goForm()">アーカイブする</button>

<canvas id="snow"></canvas>

<script>
// ——— Googleフォームへ飛ぶ ———
function goForm() {
  window.location.href = "https://docs.google.com/forms/d/e/1FAIpQLSfITfGfotqgNula8mhuvZL2ewZdNCwT24lozK8Y-8YRvZCJQg/viewform?usp=header";
}

// ——— キャンバス設定 ———
const canvas = document.getElementById("snow");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

// ——— 雪と積雪データ ———
const numFlakes = 90; // 雪の量
const flakes = [];
let groundHeight = []; // 横ドットごとの積雪量

function resetGround(){
  groundHeight = [];
  for(let x=0; x<canvas.width; x++){
    groundHeight[x] = 0;
  }
}
resetGround();

for(let i=0;i<numFlakes;i++){
  flakes.push({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height,
    r: Math.random()*4 + 2,
    speedY: Math.random()*2 + 1.5,
    speedX: Math.random()*1 - 0.5
  });
}

// ——— 描画ループ ———
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ❶ 空を舞う雪
  flakes.forEach(f=>{
    ctx.beginPath();
    ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
    ctx.fillStyle="white";
    ctx.fill();

    f.y += f.speedY;
    f.x += f.speedX;

    if(f.x < 0) f.x = canvas.width;
    if(f.x > canvas.width) f.x = 0;

    // ❷ 地面に触れたら積雪
    if(f.y >= canvas.height - groundHeight[Math.floor(f.x)]) {
      let gx = Math.floor(f.x);

      // 積もる幅を広げる（雪の広がり）
      for(let w=-6; w<=6; w++){
        let px = gx + w;
        if(px>=0 && px<canvas.width) {
          groundHeight[px] += 1.2; // 積雪量（見えるほど増やした）
        }
      }

      // 新しい雪として初期化
      f.y = -10;
      f.x = Math.random()*canvas.width;
    }
  });

  // ❸ 積もった雪を描画
  ctx.fillStyle = "white";
  for(let x=0; x<canvas.width; x++){
    ctx.fillRect(x, canvas.height-groundHeight[x], 2, groundHeight[x]); // 太さ2pxで見えやすい
  }
}

setInterval(draw, 40);

// リサイズ対応
window.addEventListener('resize',()=>{
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  resetGround();
});
</script>

</body>
</html>
